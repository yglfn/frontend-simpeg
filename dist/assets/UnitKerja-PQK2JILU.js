import{_ as ya,a as _a,b as n,e as a,n as N,t as l,h as U,v as q,f as la,G as ha,H as R,d as Ua,F as x,B as D,g as d,k as v,x as z,y as Q,T as Y,C as M,m as r,p as ia,o as i,w as A,E as w}from"./index-CerEmezX.js";import{l as wa}from"./lodash-DuUh2JXe.js";const ja={class:"app-container"},Ca={class:"unit-kerja-wrapper"},Pa={class:"modern-header"},xa={class:"header-actions"},Da=["disabled"],Ma={class:"main-card"},Fa={class:"toolbar"},Sa={class:"search-wrapper"},Ba={class:"filter-wrapper"},Ka={class:"select-wrapper"},Ta={class:"select-wrapper"},Va=["value"],$a={key:0,class:"active-filters-bar"},Ia={key:0,class:"chip"},La={key:1,class:"chip"},Na={key:2,class:"chip"},Ra={class:"table-wrapper"},Aa={key:0,class:"loading-overlay"},Ea={key:1,class:"state-container error"},Ja={key:2,class:"modern-table"},Ga={key:0},Ha={class:"text-muted"},Oa={class:"cell-primary"},qa={class:"font-bold text-dark"},za={key:0,class:"cell-meta"},Qa={key:1,class:"cell-meta text-muted"},Ya={class:"date-cell"},Wa={class:"date-main"},Xa={class:"date-sub"},Za={class:"date-cell"},at={class:"date-main"},tt={class:"date-sub"},et={class:"action-group"},st=["onClick"],nt=["onClick"],lt=["onClick"],it={key:1,class:"card-footer"},ot={class:"footer-info"},ut={key:0,class:"pagination-modern"},rt=["disabled"],dt=["onClick"],vt=["disabled"],pt={class:"modal-header"},ct={class:"header-title"},ft={class:"id-badge"},mt={class:"modal-body"},bt={class:"detail-header-block"},gt={class:"detail-titles"},kt={class:"detail-grid"},yt={class:"info-box"},_t={key:0},ht={key:1,class:"text-muted"},Ut={class:"info-box"},wt={class:"info-box"},jt={key:0,class:"info-box full-width"},Ct={class:"children-chips"},Pt={class:"modal-footer"},xt={class:"modal-header"},Dt={class:"modal-body"},Mt={class:"form-group"},Ft={class:"form-row"},St={class:"form-group half"},Bt={class:"select-wrapper fluid"},Kt={class:"form-group half"},Tt={class:"select-wrapper fluid"},Vt=["value"],$t={class:"form-actions-right"},It=["disabled"],Lt={key:0,class:"fas fa-spinner fa-spin"},Nt={class:"modal-body"},Rt={class:"modal-desc"},At={class:"form-group",style:{margin:"15px 0"}},Et={class:"d-block mb-2 text-muted small"},Jt={key:0,class:"alert-box"},Gt={class:"modal-actions-center"},Ht=["disabled"],Ot={__name:"UnitKerja",setup(qt){const _=r(!1),j=r(""),g=r(""),k=r(""),p=r(""),F=r(!1),S=r(!1),E=r(!1),B=r(!1),h=r(!1),K=r(!1),y=r([]),T=r([]),o=r(null),u=r({currentPage:1,perPage:10,total:0,lastPage:1,from:1,to:10}),f=r({nama_unit:"",jenis_unit:"",parent_id:null}),W=ia(()=>k.value||p.value!==null&&p.value!==void 0&&p.value!==""||g.value),oa=ia(()=>{const s=[],{currentPage:t,lastPage:e}=u.value,m=1;for(let c=Math.max(2,t-m);c<=Math.min(e-1,t+m);c++)s.push(c);return t-m>2&&s.unshift("..."),t+m<e-1&&s.push("..."),s.unshift(1),e>1&&s.push(e),s.filter((c,I,L)=>L.indexOf(c)===I)}),b=async()=>{try{_.value=!0,j.value="";const s={page:u.value.currentPage,per_page:u.value.perPage,search:g.value,jenis_unit:k.value||void 0,parent_id:p.value!==""?p.value:void 0},e=(await M.get("/super-admin/unit-kerja",{params:s})).data;e.success&&e.data?(y.value=e.data,u.value={currentPage:1,perPage:y.value.length||10,total:y.value.length||0,lastPage:1,from:1,to:y.value.length||0}):y.value=[]}catch(s){console.error("Error loading unit kerja:",s),j.value="Gagal memuat data unit kerja"}finally{_.value=!1}},V=async()=>{try{const s=await M.get("/super-admin/unit-kerja");s.data.success&&(T.value=s.data.data)}catch(s){console.error(s)}},ua=async()=>{var s,t;try{h.value=!0,(await M.post("/super-admin/unit-kerja",f.value)).data.success&&(w.success("Unit kerja berhasil ditambahkan"),P(),b(),V())}catch(e){w.error(((t=(s=e.response)==null?void 0:s.data)==null?void 0:t.message)||"Gagal membuat unit kerja")}finally{h.value=!1}},ra=async()=>{var s,t;try{h.value=!0,(await M.put(`/super-admin/unit-kerja/${o.value.id}`,f.value)).data.success&&(w.success("Unit kerja berhasil diperbarui"),P(),b(),V())}catch(e){w.error(((t=(s=e.response)==null?void 0:s.data)==null?void 0:t.message)||"Gagal mengupdate unit kerja")}finally{h.value=!1}},da=async()=>{try{K.value=!0,(await M.delete(`/super-admin/unit-kerja/${o.value.id}`)).data.success&&(w.success("Unit kerja berhasil dihapus"),O(),b(),V())}catch{w.error("Gagal menghapus unit kerja")}finally{K.value=!1}},X=()=>{g.value="",k.value="",p.value="",u.value.currentPage=1,b()},J=()=>{u.value.currentPage=1,b()},$=()=>{u.value.currentPage=1,b()},va=()=>{X()},G=s=>{s!=="..."&&s>=1&&s<=u.value.lastPage&&(u.value.currentPage=s,b())},Z=wa.debounce(()=>{J()},500),pa=()=>{ma(),B.value=!1,S.value=!0},aa=s=>{o.value=s,B.value=!0,S.value=!0,F.value=!1,f.value={nama_unit:s.nama_unit,jenis_unit:s.jenis_unit,parent_id:s.parent_id||null}},ca=async s=>{o.value=s,F.value=!0},C=r(""),fa=s=>{o.value=s,C.value="",E.value=!0},H=()=>{F.value=!1,o.value=null},P=()=>{S.value=!1,o.value=null},O=()=>{E.value=!1,C.value="",o.value=null},ma=()=>{f.value={nama_unit:"",jenis_unit:"",parent_id:null}},ba=async()=>{B.value?await ra():await ua()},ta=s=>s?new Date(s).toLocaleDateString("id-ID",{year:"numeric",month:"short",day:"numeric"}):"-",ea=s=>s?new Date(s).toLocaleTimeString("id-ID",{hour:"2-digit",minute:"2-digit"}):"-",sa=s=>s?new Date(s).toLocaleDateString("id-ID",{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"-",na=s=>{switch(s){case"Universitas":return"badge-indigo";case"Fakultas":return"badge-blue";case"Program Studi":return"badge-green";case"Departemen":return"badge-purple";case"Bagian":return"badge-orange";case"Sub Bagian":return"badge-gray";case"Unit":return"badge-dark";default:return"badge-red"}},ga=s=>{if(s==="null")return"Root Unit";const t=T.value.find(e=>e.id==s);return t?t.nama_unit:"Unknown"};return _a(()=>{b(),V()}),(s,t)=>(i(),n("div",ja,[a("div",Ca,[a("header",Pa,[t[18]||(t[18]=a("div",{class:"header-content"},[a("div",{class:"header-icon"},[a("i",{class:"fas fa-building"})]),a("div",{class:"header-text"},[a("h1",null,"Manajemen Unit Kerja"),a("p",null,"Atur struktur dan hierarki organisasi Anda dengan mudah.")])],-1)),a("div",xa,[a("button",{class:"btn btn-secondary btn-icon-text",onClick:X,disabled:_.value},[a("i",{class:N(["fas fa-sync-alt",{"fa-spin":_.value}])},null,2),a("span",null,l(_.value?"Memuat...":"Refresh"),1)],8,Da),a("button",{class:"btn btn-primary btn-icon-text",onClick:pa},[...t[17]||(t[17]=[a("i",{class:"fas fa-plus"},null,-1),a("span",null,"Unit Baru",-1)])])])]),a("div",Ma,[a("div",Fa,[a("div",Sa,[t[19]||(t[19]=a("i",{class:"fas fa-search"},null,-1)),U(a("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=e=>g.value=e),placeholder:"Cari unit kerja...",onKeyup:ha(J,["enter"]),onInput:t[1]||(t[1]=(...e)=>la(Z)&&la(Z)(...e))},null,544),[[q,g.value]])]),a("div",Ba,[a("div",Ka,[U(a("select",{"onUpdate:modelValue":t[2]||(t[2]=e=>k.value=e),onChange:$},[...t[20]||(t[20]=[Ua('<option value="" disabled selected data-v-c9f62f91>Filter Jenis</option><option value="" data-v-c9f62f91>Semua Jenis</option><option value="Universitas" data-v-c9f62f91>Universitas</option><option value="Fakultas" data-v-c9f62f91>Fakultas</option><option value="Program Studi" data-v-c9f62f91>Program Studi</option><option value="Departemen" data-v-c9f62f91>Departemen</option><option value="Bagian" data-v-c9f62f91>Bagian</option><option value="Sub Bagian" data-v-c9f62f91>Sub Bagian</option><option value="Unit" data-v-c9f62f91>Unit</option><option value="Lainnya" data-v-c9f62f91>Lainnya</option>',10)])],544),[[R,k.value]]),t[21]||(t[21]=a("i",{class:"fas fa-chevron-down dropdown-icon"},null,-1))]),a("div",Ta,[U(a("select",{"onUpdate:modelValue":t[3]||(t[3]=e=>p.value=e),onChange:$},[t[22]||(t[22]=a("option",{value:"",disabled:"",selected:""},"Filter Parent",-1)),t[23]||(t[23]=a("option",{value:""},"Semua Parent",-1)),t[24]||(t[24]=a("option",{value:"null"},"Root (Tanpa Parent)",-1)),(i(!0),n(x,null,D(T.value,e=>(i(),n("option",{key:e.id,value:e.id},l(e.nama_unit),9,Va))),128))],544),[[R,p.value]]),t[25]||(t[25]=a("i",{class:"fas fa-chevron-down dropdown-icon"},null,-1))]),W.value?(i(),n("button",{key:0,class:"btn-icon-only",onClick:va,title:"Reset Filter"},[...t[26]||(t[26]=[a("i",{class:"fas fa-times"},null,-1)])])):d("",!0)])]),W.value?(i(),n("div",$a,[t[27]||(t[27]=a("span",{class:"filter-label"},"Filter Aktif:",-1)),k.value?(i(),n("span",Ia,[v(l(k.value)+" ",1),a("i",{class:"fas fa-times",onClick:t[4]||(t[4]=e=>{k.value="",$()})})])):d("",!0),p.value!==""&&p.value!==void 0?(i(),n("span",La,[v(l(p.value==="null"?"Root Unit":ga(p.value))+" ",1),a("i",{class:"fas fa-times",onClick:t[5]||(t[5]=e=>{p.value="",$()})})])):d("",!0),g.value?(i(),n("span",Na,[v(' "'+l(g.value)+'" ',1),a("i",{class:"fas fa-times",onClick:t[6]||(t[6]=e=>{g.value="",J()})})])):d("",!0)])):d("",!0),a("div",Ra,[_.value?(i(),n("div",Aa,[...t[28]||(t[28]=[a("div",{class:"spinner"},null,-1)])])):d("",!0),j.value?(i(),n("div",Ea,[t[29]||(t[29]=a("div",{class:"state-icon bg-red"},[a("i",{class:"fas fa-exclamation-triangle"})],-1)),t[30]||(t[30]=a("h3",null,"Gagal Memuat Data",-1)),a("p",null,l(j.value),1),a("button",{class:"btn btn-primary",onClick:b},"Coba Lagi")])):d("",!0),j.value?d("",!0):(i(),n("table",Ja,[t[37]||(t[37]=a("thead",null,[a("tr",null,[a("th",{width:"60"},"No"),a("th",null,"Nama Unit"),a("th",null,"Jenis"),a("th",null,"Hierarki (Parent)"),a("th",null,"Tanggal Dibuat"),a("th",null,"Terakhir Diubah"),v(),a("th",{class:"text-right"},"Aksi")])],-1)),a("tbody",null,[!_.value&&y.value.length===0?(i(),n("tr",Ga,[...t[31]||(t[31]=[a("td",{colspan:"7"},[a("div",{class:"state-container empty"},[a("div",{class:"state-icon bg-blue"},[a("i",{class:"fas fa-folder-open"})]),a("h3",null,"Data Kosong"),a("p",null,"Belum ada data unit kerja yang ditemukan.")])],-1)])])):(i(!0),n(x,{key:1},D(y.value,(e,m)=>(i(),n("tr",{key:e.id},[a("td",Ha,l(u.value.from+m),1),a("td",null,[a("div",Oa,[a("span",qa,l(e.nama_unit),1)])]),a("td",null,[a("span",{class:N(["badge",na(e.jenis_unit)])},l(e.jenis_unit),3)]),a("td",null,[e.parent?(i(),n("div",za,[t[32]||(t[32]=a("i",{class:"fas fa-level-up-alt text-primary"},null,-1)),a("span",null,l(e.parent.nama_unit),1)])):(i(),n("div",Qa,[...t[33]||(t[33]=[a("i",{class:"fas fa-crown text-warning"},null,-1),a("span",null,"Root Unit",-1)])]))]),a("td",null,[a("div",Ya,[a("span",Wa,l(ta(e.created_at)),1),a("span",Xa,l(ea(e.created_at)),1)])]),a("td",null,[a("div",Za,[a("span",at,l(ta(e.updated_at)),1),a("span",tt,l(ea(e.updated_at)),1)])]),a("td",null,[a("div",et,[a("button",{class:"btn-action view",onClick:c=>ca(e),title:"Detail"},[...t[34]||(t[34]=[a("i",{class:"fas fa-eye"},null,-1)])],8,st),a("button",{class:"btn-action edit",onClick:c=>aa(e),title:"Edit"},[...t[35]||(t[35]=[a("i",{class:"fas fa-pen"},null,-1)])],8,nt),a("button",{class:"btn-action delete",onClick:c=>fa(e),title:"Hapus"},[...t[36]||(t[36]=[a("i",{class:"fas fa-trash-alt"},null,-1)])],8,lt)])])]))),128))])]))]),y.value.length>0?(i(),n("div",it,[a("div",ot,[t[38]||(t[38]=v(" Menampilkan ",-1)),a("b",null,l(u.value.from)+"-"+l(u.value.to),1),t[39]||(t[39]=v(" dari ",-1)),a("b",null,l(u.value.total),1),t[40]||(t[40]=v(" data ",-1))]),u.value.lastPage>1?(i(),n("div",ut,[a("button",{class:"page-btn prev",disabled:u.value.currentPage===1,onClick:t[7]||(t[7]=e=>G(u.value.currentPage-1))},[...t[41]||(t[41]=[a("i",{class:"fas fa-chevron-left"},null,-1)])],8,rt),(i(!0),n(x,null,D(oa.value,e=>(i(),n("button",{key:e,class:N(["page-btn number",{active:e===u.value.currentPage,dots:e==="..."}]),onClick:m=>G(e)},l(e),11,dt))),128)),a("button",{class:"page-btn next",disabled:u.value.currentPage===u.value.lastPage,onClick:t[8]||(t[8]=e=>G(u.value.currentPage+1))},[...t[42]||(t[42]=[a("i",{class:"fas fa-chevron-right"},null,-1)])],8,vt)])):d("",!0)])):d("",!0)])]),z(Y,{name:"modal-fade"},{default:Q(()=>[F.value?(i(),n("div",{key:0,class:"modal-backdrop",onClick:H},[a("div",{class:"modal-card",onClick:t[10]||(t[10]=A(()=>{},["stop"]))},[a("div",pt,[a("div",ct,[t[43]||(t[43]=a("h2",null,"Detail Unit Kerja",-1)),a("span",ft,"ID: "+l(o.value.id),1)]),a("button",{class:"btn-close",onClick:H},[...t[44]||(t[44]=[a("i",{class:"fas fa-times"},null,-1)])])]),a("div",mt,[a("div",bt,[t[45]||(t[45]=a("div",{class:"icon-circle"},[a("i",{class:"fas fa-building"})],-1)),a("div",gt,[a("h3",null,l(o.value.nama_unit),1),a("span",{class:N(["badge",na(o.value.jenis_unit)])},l(o.value.jenis_unit),3)])]),a("div",kt,[a("div",yt,[t[47]||(t[47]=a("label",null,"Parent Unit",-1)),o.value.parent?(i(),n("p",_t,[t[46]||(t[46]=a("i",{class:"fas fa-level-up-alt"},null,-1)),v(" "+l(o.value.parent.nama_unit),1)])):(i(),n("p",ht,"Root (Unit Utama)"))]),a("div",Ut,[t[48]||(t[48]=a("label",null,"Tanggal Dibuat",-1)),a("p",null,l(sa(o.value.created_at)),1)]),a("div",wt,[t[49]||(t[49]=a("label",null,"Terakhir Diubah",-1)),a("p",null,l(sa(o.value.updated_at)),1)]),o.value.children&&o.value.children.length?(i(),n("div",jt,[t[50]||(t[50]=a("label",null,"Sub Unit (Children)",-1)),a("div",Ct,[(i(!0),n(x,null,D(o.value.children,e=>(i(),n("span",{key:e.id,class:"child-chip"},l(e.nama_unit),1))),128))])])):d("",!0)])]),a("div",Pt,[a("button",{class:"btn btn-secondary",onClick:H},"Tutup"),a("button",{class:"btn btn-primary",onClick:t[9]||(t[9]=e=>aa(o.value))},"Edit Data")])])])):d("",!0)]),_:1}),z(Y,{name:"modal-fade"},{default:Q(()=>[S.value?(i(),n("div",{key:0,class:"modal-backdrop",onClick:P},[a("div",{class:"modal-card modal-md",onClick:t[14]||(t[14]=A(()=>{},["stop"]))},[a("div",xt,[a("h2",null,l(B.value?"Edit Unit Kerja":"Tambah Unit Baru"),1),a("button",{class:"btn-close",onClick:P},[...t[51]||(t[51]=[a("i",{class:"fas fa-times"},null,-1)])])]),a("div",Dt,[a("form",{onSubmit:A(ba,["prevent"]),class:"modern-form"},[a("div",Mt,[t[52]||(t[52]=a("label",{for:"nama_unit"},"Nama Unit",-1)),U(a("input",{type:"text",id:"nama_unit","onUpdate:modelValue":t[11]||(t[11]=e=>f.value.nama_unit=e),placeholder:"Misal: Fakultas Ilmu Komputer",required:""},null,512),[[q,f.value.nama_unit]])]),a("div",Ft,[a("div",St,[t[55]||(t[55]=a("label",{for:"jenis_unit"},"Jenis Unit",-1)),a("div",Bt,[U(a("select",{id:"jenis_unit","onUpdate:modelValue":t[12]||(t[12]=e=>f.value.jenis_unit=e),required:""},[...t[53]||(t[53]=[a("option",{value:""},"Pilih Jenis...",-1),a("option",{value:"Universitas"},"Universitas",-1),a("option",{value:"Fakultas"},"Fakultas",-1),a("option",{value:"Program Studi"},"Program Studi",-1),a("option",{value:"Departemen"},"Departemen",-1),a("option",{value:"Bagian"},"Bagian",-1),a("option",{value:"Sub Bagian"},"Sub Bagian",-1),a("option",{value:"Unit"},"Unit",-1),a("option",{value:"Lainnya"},"Lainnya",-1)])],512),[[R,f.value.jenis_unit]]),t[54]||(t[54]=a("i",{class:"fas fa-chevron-down dropdown-icon"},null,-1))])]),a("div",Kt,[t[58]||(t[58]=a("label",{for:"parent_id"},"Parent Unit",-1)),a("div",Tt,[U(a("select",{id:"parent_id","onUpdate:modelValue":t[13]||(t[13]=e=>f.value.parent_id=e)},[t[56]||(t[56]=a("option",{value:null},"Tidak Ada (Root)",-1)),(i(!0),n(x,null,D(T.value,e=>(i(),n("option",{key:e.id,value:e.id},l(e.nama_unit),9,Vt))),128))],512),[[R,f.value.parent_id]]),t[57]||(t[57]=a("i",{class:"fas fa-chevron-down dropdown-icon"},null,-1))])])]),a("div",$t,[a("button",{type:"button",class:"btn btn-text",onClick:P},"Batal"),a("button",{type:"submit",class:"btn btn-primary",disabled:h.value},[h.value?(i(),n("i",Lt)):d("",!0),v(" "+l(h.value?"Menyimpan...":"Simpan Perubahan"),1)],8,It)])],32)])])])):d("",!0)]),_:1}),z(Y,{name:"modal-fade"},{default:Q(()=>{var e,m,c,I,L;return[E.value?(i(),n("div",{key:0,class:"modal-backdrop",onClick:O},[a("div",{class:"modal-card modal-sm text-center",onClick:t[16]||(t[16]=A(()=>{},["stop"]))},[a("div",Nt,[t[66]||(t[66]=a("div",{class:"warning-icon"},[a("i",{class:"fas fa-trash"})],-1)),t[67]||(t[67]=a("h3",null,"Hapus Unit?",-1)),a("p",Rt,[t[59]||(t[59]=v(" Anda akan menghapus ",-1)),a("strong",null,l((e=o.value)==null?void 0:e.nama_unit),1),t[60]||(t[60]=v(". Tindakan ini ",-1)),t[61]||(t[61]=a("strong",null,"tidak dapat dibatalkan",-1)),t[62]||(t[62]=v(". ",-1))]),a("div",At,[a("label",Et,[t[63]||(t[63]=v("Ketik ",-1)),a("strong",null,l(((m=o.value)==null?void 0:m.nama_unit)||"KONFIRMASI"),1),t[64]||(t[64]=v(" untuk melanjutkan:",-1))]),U(a("input",{type:"text","onUpdate:modelValue":t[15]||(t[15]=ka=>C.value=ka),class:"form-control text-center",placeholder:"Ketik disini...",style:{width:"100%",padding:"8px",border:"1px solid #ddd","border-radius":"6px"}},null,512),[[q,C.value]])]),((I=(c=o.value)==null?void 0:c.children)==null?void 0:I.length)>0?(i(),n("div",Jt,[t[65]||(t[65]=a("i",{class:"fas fa-exclamation-circle"},null,-1)),a("span",null,"Unit ini memiliki "+l(o.value.children.length)+" sub-unit.",1)])):d("",!0),a("div",Gt,[a("button",{class:"btn btn-secondary",onClick:O},"Batal"),a("button",{class:"btn btn-danger",onClick:da,disabled:K.value||C.value!==(((L=o.value)==null?void 0:L.nama_unit)||"KONFIRMASI")},l(K.value?"Menghapus...":"Ya, Hapus"),9,Ht)])])])])):d("",!0)]}),_:1})]))}},Yt=ya(Ot,[["__scopeId","data-v-c9f62f91"]]);export{Yt as default};
